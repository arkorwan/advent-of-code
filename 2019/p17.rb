require './intcode.rb'

a = IO.read("in17.txt").split(",").map(&:to_i)
v = IntCode.new(a)

mp = v.run_string.split

# part 1

s = 0
1.upto(mp.size-2){|y|
	1.upto(mp[0].size-2){|x|
		if [mp[y][x], mp[y][x-1],  mp[y][x+1], mp[y-1][x], mp[y+1][x]].uniq == ["#"]
			s += y*x 
			#p [x, y]
		end
	}
}

p s

# part 2

# "......................###########........"
# "......................#.........#........"
# "......................#.........#........"
# "......................#.........#........"
# "......................#.........#........"
# "......................#.........#........"
# "......................#.........#####...."
# "......................#.............#...."
# "......................#.............#...."
# "......................#.............#...."
# "......#####.....#######.............#...."
# "......#...#.....#...................#...."
# "......#...#.....#...........#############"
# "......#...#.....#...........#.......#...#"
# "###########.....#...........#.......#...#"
# "#.....#.........#...........#.......#...#"
# "#.....#.......#####.........#.......#####"
# "#.....#.......#.#.#.........#............"
# "#.....#.......#.#.#.........#............"
# "#.....#.......#.#.#.........#............"
# "#############.#.#.#.........#............"
# "......#.....#.#.#.#.........#............"
# "......###########.###########............"
# "............#.#.........................."
# "..........##########^...................."
# "..........#.#.#.........................."
# "#####.....#.#.#############.............."
# "#...#.....#.#.............#.............."
# "#...#.....#.#.............#.............."
# "#...#.....#.#.............#.............."
# "#############.............#.............."
# "....#.....#...............#.............."
# "....#.....#...............###########...."
# "....#.....#.........................#...."
# "....#.....#.........................#...."
# "....#.....#.........................#...."
# "....#######.........................#...."
# "....................................#...."
# "....................................#...."
# "....................................#...."
# "....................................#...."
# "....................................#...."
# "..............................#######...."
# "..............................#.........."
# "..............................#.........."
# "..............................#.........."
# "..............................#.........."

ins_main = "A,B,A,B,A,C,B,C,A,C"
ins_a = "L,10,L,12,R,6"
ins_b = "R,10,L,4,L,4,L,12"
ins_c = "L,10,R,10,R,6,L,4"

a[0] = 2
v2 = IntCode.new(a)

def ser(ins)
	ins.each_byte.to_a << 10
end

v2.push_string(ins_main)
puts v2.run_string
v2.push_string(ins_a)
puts v2.run_string
v2.push_string(ins_b)
puts v2.run_string
v2.push_string(ins_c)
puts v2.run_string
v2.push_string('n')
puts v2.run[-1]

